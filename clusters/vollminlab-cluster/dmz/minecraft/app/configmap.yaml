apiVersion: v1
kind: ConfigMap
metadata:
  name: minecraft-values
  namespace: dmz
  labels:
    app: minecraft
    env: production
    category: gaming
data:
  values.yaml: |
    image:
      repository: itzg/minecraft-server
      tag: latest
    persistence:
      enabled: true
      size: 20Gi
      storageClass: longhorn
    service:
      type: NodePort
      nodePort: 32565
      externalTrafficPolicy: Local
    nodeSelector:
      kubernetes.io/hostname: k8sworker05
    resources:
      requests:
        cpu: 2000m
        memory: 6Gi
      limits:
        cpu: 4000m
        memory: 8Gi
    env:
      EULA: "TRUE"
      TYPE: "PAPER"
      MEMORY: "6G"
      VIEW_DISTANCE: "8"
      SIMULATION_DISTANCE: "6"
      ENABLE_RCON: "FALSE"
    readinessProbe:
      tcpSocket:
        port: 25565
      initialDelaySeconds: 10
      periodSeconds: 10
    networkPolicy:
      enabled: true
      ingress:
        - from:
            - ipBlock:
                cidr: 192.168.160.4/32
          ports:
            - protocol: TCP
              port: 25565
      egress:
        - to:
            - ipBlock:
                cidr: 0.0.0.0/0
          ports:
            - protocol: TCP
              port: 443
            - protocol: TCP
              port: 80
