#!/usr/bin/env groovy

multibranchPipelineJob('k8s-test-deploy') {
    displayName('Kubernetes Test Deployment')

    branchSources {
        github {
            id('k8s-test-deploy')
            repoOwner('svollmi1')
            repository('k8s-vollminlab-cluster')
            configuredByUrl(true)
            credentialsId('github-pat')
        }
    }

    triggers {
        periodicFolderTrigger {
            interval('1d')
        }
    }

    orphanedItemStrategy {
        discardOldItems {
            numToKeep(10)
            daysToKeep(30)
        }
    }

    configure { project ->
        project / 'properties' / 'org.jenkinsci.plugins.workflow.job.properties.DurabilityHintJobProperty' {
            hint('PERFORMANCE_OPTIMIZED')
        }
    }
}
